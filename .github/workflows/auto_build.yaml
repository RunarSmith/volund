name: Parallel and Sequential Jobs Example

on:
  push:
    branches: [ main ] # Ou tout autre d√©clencheur voulu

jobs:

  # --- Base -----------------------------------------

  base-arch:
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-arch"
          base_distrib: "arch"
          image_role: "base"
          image_version: "0.1.0"

  base-blackarch:
    runs-on: windows-2025
    needs: base-arch
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-blackarch"
          base_distrib: "blackarch"
          image_role: "base"
          image_version: "0.1.0"

  base-debian:
    runs-on: windows-2025
    needs: base-arch
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-debian"
          base_distrib: "debian"
          image_role: "base"
          image_version: "0.1.0"

  base-fedora:
    runs-on: windows-2025
    needs: base-arch
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-fedora"
          base_distrib: "fedora"
          image_role: "base"
          image_version: "0.1.0"

  base-kali:
    runs-on: windows-2025
    needs: base-arch
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-kali"
          base_distrib: "kali"
          image_role: "base"
          image_version: "0.1.0"

  base-parrot:
    runs-on: windows-2025
    needs: base-arch
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "base-parrot"
          base_distrib: "parrot"
          image_role: "base"
          image_version: "0.1.0"

  # --- DevSecOps -----------------------------------------

  devsecops-arch:
    needs: base-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "devsecops-arch"
          base_distrib: "arch"
          image_role: "devsecops"
          image_version: "0.1.0"

  devsecops-debian:
    needs: 
      - devsecops-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "devsecops-debian"
          base_distrib: "debian"
          image_role: "devsecops"
          image_version: "0.1.0"

  devsecops-fedora:
    needs: 
      - devsecops-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "devsecops-fedora"
          base_distrib: "fedora"
          image_role: "devsecops"
          image_version: "0.1.0"

  # --- OffSec -----------------------------------------

  offsec-arch:
    needs: devsecops-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "offsec-arch"
          base_distrib: "arch"
          image_role: "offsec"
          image_version: "0.1.0"

  offsec-debian:
    needs: 
      - offsec-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "offsec-debian"
          base_distrib: "debian"
          image_role: "offsec"
          image_version: "0.1.0"

  offsec-fedora:
    needs: 
      - offsec-arch
    runs-on: windows-2025
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/vol_build_image
        with:
          image_name: "offsec-fedora"
          base_distrib: "fedora"
          image_role: "offsec"
          image_version: "0.1.0"
